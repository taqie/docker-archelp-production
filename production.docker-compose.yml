version: '3.7'

services:
  archelp:
    image: taqie/archelp
    volumes:
      - archelp_data:/var/www/html/storage/app
#    extra_hosts:
#      - "database:172.17.0.4"
    environment:
      - APP_KEY=${APP_KEY}
      - DB_DATABASE=${DB_DATABASE}
      - DB_USERNAME=${DB_USERNAME}
      - DB_PASSWORD=${DB_PASSWORD}
      - MAIL_USERNAME=${MAIL_USERNAME}
      - MAIL_PASSWORD=${MAIL_PASSWORD}
      - AWS_ACCESS_KEY_ID=${AWS_ACCESS_KEY_ID}
      - AWS_SECRET_ACCESS_KEY=${AWS_SECRET_ACCESS_KEY}
      - LOG_DISCORD_WEBHOOK_URL=${LOG_DISCORD_WEBHOOK_URL}
      - PROMOSMS_LOGIN=${PROMOSMS_LOGIN}
      - PROMOSMS_PASSWORD=${PROMOSMS_PASSWORD}
      - REDIS_HOST=redis
      - DB_HOST=database
    tty: true
    networks:
      default:
      archelp:
      archelp_def:
  redis:
    image: redis
    networks:
      - archelp

networks:
  archelp:
  archelp_def:
    external: true
    name: master
  default:
    external: true
    name: intranet

volumes:
  archelp_data:
